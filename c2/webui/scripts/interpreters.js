TERMINAL={}

TERMINAL['test']={holy: {
                            crap: function(arg) {
                            }
                            }
                    }

TERMINAL['plugin']={}
TERMINAL['plugin']['interpreter']={run: function(plugin_args){
                        console.log(plugin_args)
                        if(plugin_args == null){
                            plugin_args=""
                        }
                        args=this.get_command()
                        if(args.startsWith("run")){
                            args = args.substr(3).trim()
                            plugin_args= args
                        }
                        GLOBAL['selected']['cmd'] =  "run"
                        GLOBAL['selected']['args'] = plugin_args
                        sendAgentCmd();
                        this.echo("OK command queued ...")

                        },  
                        help: function(){
                            this.echo(`
                            -----help------
                            run [arg] : Run plugin. [Arg] is optional and needs to be quoted.
                                        Example -  run "--test=123"
                            ---------------
                            
                            `)
                        },
                        exit: function(){
                            this.pop()
                        }
                       }
TERMINAL['plugin']['options']={
                              }

TERMINAL['plugin']['shell'] = function(command) {
        if(command.startsWith("exit")){
            this.pop()
            return
        }
        args=this.get_command()
        GLOBAL['selected']['cmd'] =  "run"
        GLOBAL['selected']['args'] = args
        sendAgentCmd();

    }
// Colorize Prompt

$.terminal.new_formatter(function(string) {
                            return string.replace(/^Plugin>([\w-_]+)>(\w+-\w+-\w+)>/g, '[[;green;]Plugin][[;yellow;] > ][[;green;]$1][[;yellow;] > ][[;green;]$2][[;yellow;] > ]');
                        });