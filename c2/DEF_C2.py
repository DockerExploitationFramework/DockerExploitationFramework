import time
import uuid


class AgentConnection:
    def __init__(self, id):
        self.id = id
        self.is_alive = True
        self.last_seen = time.time()
        self.command_queue = []
        self.results = {}
    
    def serve_cmd(self):
        if len(self.command_queue) <= 0:
            return []
        
        cmd = self.command_queue.pop(0)
        self.results[cmd.execution_id] = None # move to results queue
        return cmd.export()

    
            



class AgentCommand:
    DOWNLOAD = 'download'
    RUN = 'run'

    def __init__(self, cmd, params = None):
        self.cmd = cmd
        self.params = None
        self.execution_id = str(uuid.uuid4())
        self.timestamp = int(time.time())

    
    def export(self):
        return self.__dict__

